// functions to compute output sizes